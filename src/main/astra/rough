agent Main {
    module EIS ei;
    module Console C;
    types tower {
        formula free(string);   // Block is free
        formula tower(string, string, string);  // Three-block tower configuration
        formula L(list);  // List of blocks
        formula add(string);

    }

    initial L([]);  // Initialize the list globally

    rule +!main(list args) {
        ei.launch("hw","dependency/tower-1.3.0.jar");
        ei.init();
        ei.start();
        ei.link("gripper");
        C.println("Press New Block until block d is created...");

        wait(ei.block("d"));
        C.println("You did it!");
        C.println("adda" + list L);
        ei.pickup("d");

        wait(ei.holding("d"));
        ei.putdown("d", "c");
        wait(ei.on("d", "c"));
    }

    rule +$ei.event(holding(string Y)) {
        C.println("I picked up: " + Y);
    }

    rule +$ei.event(funct Y) {
        !add(Y);
        C.println("Handling belief update: " + Y);
        C.println("New block created: " + Y);  // Debugging: new block creation

    }


    rule +!add(block(string A)):L(list L){
     -L(L);  // Remove the old belief
     +L(L + [A]);  //
     C.println(L + [A]);
    }

}